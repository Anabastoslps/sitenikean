"use strict";window.zeZipReader={},zeZipReader.ZIP_EXTRACTOR_EXTRA_FIELD_SIGNATURE=17754,zeZipReader.ERR_HEADER_PARSE_ERROR="ZIP file is invalid or corrupted",zeZipReader.ERR_HEADER_UNSUPPORTED="ZIP file format is not supported",zeZipReader.ERR_HEADER_BAD_FORMAT="This file does not appear to be a ZIP file",zeZipReader.ERR_HEADER_READ="Error when reading the ZIP header",zeZipReader.ERR_ENTRY_BAD_FORMAT="ZIP entry format error",zeZipReader.ERR_ENCRYPTED="Password-protected ZIP files are not yet supported",zeZipReader.ERR_READ_GETDATA="Error while reading ZIP file array data",zeZipReader.ERR_READ_GETENTRIES="Error while reading ZIP file header",zeZipReader.ERR_INFLATION="Error while decompressing ZIP entry",zeZipReader.CENTRAL_DIRECTORY_HEADER_SIZE=46,zeZipReader.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES=30,zeZipReader.EOCDR_SIZE=22,zeZipReader.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH=12,zeZipReader.ZIP_COMMENT_MAX_LEN=65536,zeZipReader.ZIP64_EOCDR_LOCATOR_SIZE=20,zeZipReader.ZIP64_EXTENSIBLE_DATA_SECTOR_MAX_SIZE=4096,zeZipReader.ZIP64_EOCDR_FIXED_SIZE=56,zeZipReader.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE=1,zeZipReader.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIZE=28,zeZipReader.UNICODE_PATH_EXTRA_DATA_SIGNATURE=28789,zeZipReader.UNICODE_COMMENT_EXTRA_DATA_SIGNATURE=25461,zeZipReader.UNICODE_PATH_PREAMBLE_SIZE=5,zeZipReader.AES_EXTRA_DATA_SIGNATURE=39169,zeZipReader.AES_EXTRA_DATA_SIZE=7,zeZipReader.MAX_EOCDR_HEADER_SEEK_LEN=zeZipReader.EOCDR_SIZE+zeZipReader.ZIP_COMMENT_MAX_LEN+zeZipReader.ZIP64_EOCDR_LOCATOR_SIZE+zeZipReader.ZIP64_EXTENSIBLE_DATA_SECTOR_MAX_SIZE+zeZipReader.ZIP64_EOCDR_FIXED_SIZE,zeZipReader.COMPRESSION_MODE_STORE=0,zeZipReader.COMPRESSION_MODE_DEFLATE=8,zeZipReader.COMPRESSION_MODE_ENHANCED_DEFLATE=9,zeZipReader.COMPRESSION_MODE_BZIP=12,zeZipReader.COMPRESSION_MODE_LZMA=14,zeZipReader.COMPRESSION_MODE_ZSTD=93,zeZipReader.COMPRESSION_MODE_XZ=95,zeZipReader.COMPRESSION_MODE_JPEG=96,zeZipReader.COMPRESSION_MODE_WAVPACK=97,zeZipReader.COMPRESSION_MODE_PPMD=98,zeZipReader.COMPRESSION_MODE_WINZIPENCRYPTED=99,zeZipReader.ZIP_CENTRAL_DIRECTORY_HEADER_SIGNATURE=1347092738,zeZipReader.ZIP_LOCAL_FILE_HEADER_SIGNATURE=1347093252,zeZipReader.ZIP_DATA_DESCRIPTOR_SIGNATURE=1347094280,zeZipReader.ZIP_DATA_ARCHIVE_EXTRA_DATA_SIGNATURE=1347094024,zeZipReader.ZIP_64_EOCDR_DIGITAL_HEADER_SIGNATURE=1347093765,zeZipReader.ZIP_64_EOCDR_SIGNATURE=1347094022,zeZipReader.ZIP_64_EOCDR_LOCATOR_SIGNATURE=1347094023,zeZipReader.EOCDR_SIGNATURE=1347093766,zeZipReader.ASCII_TABLE=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "],zeZipReader.decodeASCIIBytes=function(e){for(var r="",i=0;i<e.length;i++){var t=e[i];r+=127<t?zeZipReader.ASCII_TABLE[t-128]:String.fromCharCode(t)}return r},zeZipReader.isValidUtf8=function(e){for(var r=0,i=0,t=0,E=e.length;t!=e.length;){var a=255&e[t];if(a<=127)t+=1;else{if(194<=a&&a<=223)r=2;else if(224<=a&&a<=239)r=3;else{if(!(240<=a&&a<=244))return!1;r=4}if(E<=t+(r-1))return!1;for(var R=1;R<r;R++)if(128!=(192&e[t+R]))return!1;if(2==r)i=((31&e[t])<<6)+(63&e[t+1]);else if(3==r){if((i=((15&e[t])<<12)+((63&e[t+1])<<6)+(63&e[t+2]))<2048)return!1;if(i>>11==27)return!1}else if(4==r&&((i=((7&e[t])<<18)+((63&e[t+1])<<12)+((63&e[t+2])<<6)+(63&e[t+3]))<65536||1114111<i))return!1;t+=r}}return!0},zeZipReader.decodeStringFromDataView=function(e,r,i,t,E){i=new Uint8Array(e.buffer,r,i);return zeZipReader.decodeStringFromTypedArray(i,t,E)},zeZipReader.decodeStringFromTypedArray=function(r,e,i){try{return i?new TextDecoder(i).decode(r):e?ze.App.TEXTDECODER_UTF8?ze.App.TEXTDECODER_UTF8.decode(r):ze.App.decodeUTF8Bytes(r):ze.App.TEXTDECODER_ASCII?ze.App.TEXTDECODER_ASCII.decode(r):zeZipReader.decodeASCIIBytes(r)}catch(e){logImpression("decode_string_error","misc",e);try{return zeZipReader.decodeASCIIBytes(r)}catch(e){return"Error: "+e}}},zeZipReader.convertDate=function(e){var r=(4294901760&e)>>16,i=65535&e;try{return new Date(1980+((65024&r)>>9),((480&r)>>5)-1,31&r,(63488&i)>>11,(2016&i)>>5,2*(31&i),0)}catch(e){return null}},zeZipReader.generateSpecialErrorDetailsStringForZipEocdrError=function(e,r,i,t,E){try{var a="Details: ("+ze.App.getFileExtension(r)+", "+i;if(!(2<=e.size))return void t(a+")");ze.App.blobToByteArrayAsync(e,0,2,function(e){e=a+", "+e[0]+", "+e[1]+")";t(e)},E)}catch(e){return void E(e)}},zeZipReader.readHeaderMetadataFromEocdr=function(e,r,i,t,E,a){ze.App.blobToDataViewAsync(e,Math.max(0,e.size-zeZipReader.MAX_EOCDR_HEADER_SEEK_LEN),e.size,bindFn(zeZipReader.readZipHeaderRecordMetadata,null,e,r,i,t,E,a),a)},zeZipReader.readZipHeaderRecordMetadata=function(e,r,i,t,E,a,R){e.size;try{if(0==R.byteLength)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - ZIP file is empty (zero bytes) and contains no actual data.");if(R.byteLength<zeZipReader.EOCDR_SIZE)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - ZIP file size is not large enough for EOCDR.");for(var n=-1,o=R.byteLength-zeZipReader.EOCDR_SIZE;o<R.byteLength-4;o++)if(R.getUint32(o)==zeZipReader.EOCDR_SIGNATURE){n=o;break}var d,p=0;if(-1==n)for(p=Math.max(0,R.byteLength-zeZipReader.MAX_EOCDR_HEADER_SEEK_LEN);p<R.byteLength-4;p++)R.getUint32(p)==zeZipReader.EOCDR_SIGNATURE&&(n=p);if(-1==n)return void(null==i||i==ze.App.CANONICAL_MIME_TYPES.ZIP||i==ze.App.CANONICAL_MIME_TYPES.ZIP2||i==ze.App.CANONICAL_MIME_TYPES.ZIP3?(d=zeZipReader.ERR_HEADER_PARSE_ERROR+" - Did not find EOCDR signature. Please try re-downloading your ZIP file from the original source.",zeZipReader.generateSpecialErrorDetailsStringForZipEocdrError(e,r,i,function(e){a(d+" - "+e)},function(e){a(d+" - "+e)})):a("This file does not appear to be a ZIP file. Instead, this file's type was detected as: "+i,!1,!0,i,e));if(R.byteLength-n<zeZipReader.EOCDR_SIZE)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - EOCDR not large enough");var _={};if(0<=n-zeZipReader.ZIP64_EOCDR_LOCATOR_SIZE)if(R.getUint32(n-20)==zeZipReader.ZIP_64_EOCDR_LOCATOR_SIGNATURE){_.isZip64=!0;var Z=zeZipReader.readUint64FromDataView(R,n-12,!0);if(!Number.isSafeInteger(Z))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 EOCDR Relative Offset > MAX_SAFE_INTEGER");var s=t-Z;if(s<0)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - Zip64 Negative offset from end (last: "+t+", relOffset: "+Z+")");var A=R.byteLength-s;if((_.zip64Index=A)<0)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - Not enough bytes to reverse-seek to ZIP64 EOCDR");if(R.getUint32(A)!=zeZipReader.ZIP_64_EOCDR_SIGNATURE)return void a(zeZipReader.ERR_HEADER_PARSE_ERROR+" - Did not find ZIP64 EOCDR signature where expected");var I=R.getUint32(4+A,!0);if(0<R.getUint32(8+A,!0))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 EocdrSize > Integer.MAX_VALUE, requires long");_.zip64EocdrSize=I;var z=R.getUint32(16+A,!0),D=R.getUint32(20+A,!0);if(z!=D)return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 NumberOfThisDisk != ZIP64 NumberOfTheDiskWithCD");_.zip64NumberOfThisDisk=z,_.zip64NumberOfTheDiskWithStartOfCentralDirectory=D;Z=R.getUint32(24+A,!0);if(0<R.getUint32(28+A,!0))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 TotalEntriesOnDisk > Integer.MAX_VALUE, requires long");_.zip64TotalEntriesOnDisk=Z;s=R.getUint32(32+A,!0);if(0<R.getUint32(36+A,!0))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 TotalEntriesInCd > Integer.MAX_VALUE, requires long");_.zip64TotalEntriesInCd=s;z=R.getUint32(40+A,!0);if(0<R.getUint32(44+A,!0))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 CdSize > Integer.MAX_VALUE, requires long");_.zip64CdSize=z;D=zeZipReader.readUint64FromDataView(R,48+A,!0);if(!Number.isSafeInteger(D))return void a(zeZipReader.ERR_HEADER_UNSUPPORTED+" - ZIP64 CdOffsetOfStart > MAX_SAFE_INTEGER");_.zip64CdOffsetOfStart=D;Z=I-zeZipReader.ZIP64_EOCDR_FIXED_SIZE+12;_.zip64ExtensibleDataSectorSize=Z}s=R.getUint16(n+4,!0);65535==s&&_.isZip64&&(s=_.zip64NumberOfThisDisk),_.numberOfThisDisk=s;z=R.getUint16(n+6,!0);65535==z&&_.isZip64&&(z=_.zip64NumberOfTheDiskWithStartOfCentralDirectory),_.numberOfTheDiskWithStartOfCentralDirectory=z,_.numExtraZipParts=Math.max(s,z);A=R.getUint16(n+8,!0);65535==A&&_.isZip64&&(A=_.zip64TotalEntriesInCd);D=R.getUint32(n+12,!0);4294967295==D&&_.isZip64&&(D=_.zip64CdSize);I=R.getUint32(n+16,!0);4294967295==I&&_.isZip64&&(I=_.zip64CdOffsetOfStart);Z=_.isZip64?_.zip64Index:n,s=R.byteLength-Z,z=R.getUint16(n+20,!0),Z="";return 0<z&&(Z=zeZipReader.decodeStringFromDataView(R,n+22,z,!0)),_.numFiles=A,_.cdrAbsoluteOffset=I,_.cdrSize=D,_.zipFileComment=Z,_.eocdrStartDistanceFromEnd=s,_.cdrStartDistanceFromEnd=s+D,void E(_)}catch(e){return console.log(e),console.trace(),e.message||(e.message=""),e.message=zeZipReader.ERR_HEADER_PARSE_ERROR+" - General Error - "+e.message,void a(e)}},zeZipReader.readEntriesFromCentralDirectory=function(e,r,i,t){r.size<e.cdrStartDistanceFromEnd?t(zeZipReader.ERR_HEADER_READ+" - Tail blob size not large enough for CDR"):ze.App.blobToDataViewAsync(r,r.size-e.cdrStartDistanceFromEnd,r.size,bindFn(zeZipReader.doReadEntriesFromCdr,null,i,t,e.numFiles,!!e.isZip64,e.encoding),t)},zeZipReader.doReadEntriesFromCdr=function(e,r,i,t,E,a){for(var R=0,n=1,o=[],d=0;d<i;d++){if(a.getUint32(R)!=zeZipReader.ZIP_CENTRAL_DIRECTORY_HEADER_SIGNATURE)return void r(zeZipReader.ERR_HEADER_BAD_FORMAT+" - Expected Header Signature for this file's record");var p={};try{p=zeZipReader.generateEntryFromHeaderRecord(a,R+4,t,E)}catch(e){p.error="Entry Parse Error from CDR: "+e;var _=ze.App.getErrorDetailsFromErrorObject(e);logImpression("entry_parse_error_cdr","zip",(e||"")+" - isZip64: "+t+"; entry.filenameLength: "+p.filenameLength+"; opt_encoding: "+E+"; errDetails: "+_)}p.error||null!=p.compressionMethod&&(zeZipReader.isZipCompressionMethodSupported(p.compressionMethod)||(p.error="Unsupported ZIP compression method: "+p.compressionMethod,logImpression("entry_unsupported_compression_method","zip",p.compressionMethod))),ze.App.postProcessEntryFilenameAndMaybeSkip(p,n++)||o.push(p),R+=zeZipReader.CENTRAL_DIRECTORY_HEADER_SIZE+p.filenameLength+p.extraFieldLength+p.commentLength}e(o)},zeZipReader.isZipCompressionMethodSupported=function(e){return e==zeZipReader.COMPRESSION_MODE_DEFLATE||e==zeZipReader.COMPRESSION_MODE_ENHANCED_DEFLATE||e==zeZipReader.COMPRESSION_MODE_STORE||e==zeZipReader.COMPRESSION_MODE_BZIP||e==zeZipReader.COMPRESSION_MODE_LZMA||e==zeZipReader.COMPRESSION_MODE_XZ||e==zeZipReader.COMPRESSION_MODE_PPMD||e==zeZipReader.COMPRESSION_MODE_WINZIPENCRYPTED},zeZipReader.generateEntryFromHeaderRecord=function(e,r,i,t){var E={type:"zip"};E.madeByVersion=e.getUint16(r,!0),E.version=e.getUint16(r+2,!0),E.bitFlag=e.getUint16(r+4,!0),E.compressionMethod=e.getUint16(r+6,!0),E.lastModDateRaw=e.getUint32(r+8,!0),E.lastModDate=zeZipReader.convertDate(E.lastModDateRaw),zeZipReader.populateEntryEncryptionDetails(E);var a=!1,R=!1,n=!1,o=!1;E.crc32=e.getUint32(r+12,!0),0===E.crc32&&(E.crc32=null),E.compressedSize=e.getUint32(r+16,!0),E.uncompressedSize=e.getUint32(r+20,!0),4294967295!==E.uncompressedSize&&4294967295!==E.compressedSize||(E.isZip64=!0,4294967295===E.uncompressedSize&&(R=!0),4294967295===E.compressedSize&&(a=!0)),E.filenameLength=e.getUint16(r+24,!0),E.extraFieldLength=e.getUint16(r+26,!0),E.commentLength=e.getUint16(r+28,!0);var d=e.getUint16(r+30,!0);65535===d?o=E.isZip64=!0:E.diskNumberStart=d,E.directory=16==(16&e.getUint8(r+34));var p=e.getUint32(r+38,!0);4294967295===p?n=E.isZip64=!0:E.offset=p;d=r+42+E.filenameLength,p=zeZipReader.readExtraFields(e,d,E.extraFieldLength);if(E.isZip64){d=0;if(R&&(d+=8),a&&(d+=8),n&&(d+=8),o&&(d+=4),0<d){if(!(zeZipReader.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE in p))return E.error="Did not find ZIP64_EXTENDED_INFO_EXTRA_FIELD for this Zip64 entry.",E;var _=p[zeZipReader.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE];if(_.dataSize<d)return E.error="Error: Expected Extra Field Length at least "+d+" for Zip64 Entry, but was: "+_.dataSize,E;_=_.dataStart;if(R){R=zeZipReader.readUint64FromDataView(e,_,!0);if(!Number.isSafeInteger(R))return E.error="Error: ZIP64 Entry Uncompressed Size > MAX_SAFE_INTEGER",E;E.uncompressedSize=R,_+=8}if(a){a=zeZipReader.readUint64FromDataView(e,_,!0);if(!Number.isSafeInteger(a))return E.error="Error: ZIP64 Entry Compressed Size > MAX_SAFE_INTEGER",E;E.compressedSize=a,_+=8}if(n){n=zeZipReader.readUint64FromDataView(e,_,!0);if(!Number.isSafeInteger(n))return E.error="Error: ZIP64 Entry Offset > MAX_SAFE_INTEGER",E;E.offset=n,_+=8}o&&(o=e.getUint32(_,!0),E.diskNumberStart=o,_+=4)}}var Z=!1,_=2048==(2048&E.bitFlag);if(zeZipReader.UNICODE_PATH_EXTRA_DATA_SIGNATURE in p){var s=p[zeZipReader.UNICODE_PATH_EXTRA_DATA_SIGNATURE],A=s.dataStart+zeZipReader.UNICODE_PATH_PREAMBLE_SIZE,I=s.dataSize-zeZipReader.UNICODE_PATH_PREAMBLE_SIZE;try{E.filename=zeZipReader.decodeStringFromDataView(e,A,I,!0,void 0),Z=!0}catch(e){logImpression("unicode_path_extra_data_parse_error","zip","error: "+e)}}if(!Z){var z=new Uint8Array(e.buffer,r+42,E.filenameLength),s=!1;if(_)s=!0;else{for(var D=!1,O=0;O<z.length;O++)if(127<z[O]){D=!0,E.filenameHasExtendedChar=!0;break}E.rawFilenameBytes=z,s=!!D&&zeZipReader.isValidUtf8(z)}E.filename=zeZipReader.decodeStringFromTypedArray(z,s,t)}if(E.directory||"/"!=E.filename.charAt(E.filename.length-1)||(E.directory=!0),0<E.commentLength?E.comment=zeZipReader.decodeStringFromDataView(e,r+42+E.filenameLength+E.extraFieldLength,E.commentLength,_,void 0):E.comment="",E.encryptionMode==zeZipReader.ENCRYPTION_MODE_WINZIPAES){if(!(zeZipReader.AES_EXTRA_DATA_SIGNATURE in p))return E.error="Error: Did not find AES Extra Data Record Extra Fields Map.",E;var T=p[zeZipReader.AES_EXTRA_DATA_SIGNATURE];if(T.dataSize<zeZipReader.AES_EXTRA_DATA_SIZE)return E.error="Error: Expected Extra Field Length >= 7 for AES encryption format.",E;var S=null;try{S=zeZipReader.Crypto.Aes.readAesExtraDataRecord(e,T.dataStart)}catch(e){return E.error="Error reading Encryption Data Record: "+e,E}null!=S&&(E.compressionMethod=S.compressionMethod,E.aesKeyStrengthBits=S.keyStrengthBits)}return E},zeZipReader.readUint64FromDataView=function(e,r,i){var t=e.getUint32(r,!!i),r=e.getUint32(r+4,!!i);return i?t+Math.pow(2,32)*r:r+Math.pow(2,32)*t},zeZipReader.readExtraFields=function(e,r,i){var t={},E=r;for(null==i&&(i=0);E<r+i;){var a=e.getUint16(E,!0);E+=2;var R=e.getUint16(E,!0),n={dataStart:E+=2,dataSize:R};E+=R,t[a]=n}return t},zeZipReader.ENCRYPTION_MODE_NONE="none",zeZipReader.ENCRYPTION_MODE_UNKNOWN="unknown",zeZipReader.ENCRYPTION_MODE_PKZIPSTANDARD="pkzipstandard",zeZipReader.ENCRYPTION_MODE_PKZIPSTRONG="pkzipstrong",zeZipReader.ENCRYPTION_MODE_WINZIPAES="winzipaes",zeZipReader.ENCRYPTION_MODE_PKZIPOTHER="pkzipother",zeZipReader.ENCRYPTION_MODE_ENCRYPTEDCDR="encryptedcdr",zeZipReader.populateEntryEncryptionDetails=function(e){e.encryptionMode=zeZipReader.ENCRYPTION_MODE_NONE,e.isEncrypted=1==(1&e.bitFlag),e.hasEncryptedCdr=8192==(8192&e.bitFlag),e.isEncrypted&&(e.hasEncryptedCdr?e.encryptionMode=zeZipReader.ENCRYPTION_MODE_ENCRYPTEDCDR:(e.encryptionMode=zeZipReader.ENCRYPTION_MODE_UNKNOWN,e.compressionMethod==zeZipReader.COMPRESSION_MODE_WINZIPENCRYPTED?e.encryptionMode=zeZipReader.ENCRYPTION_MODE_WINZIPAES:64==(64&e.bitFlag)?e.encryptionMode=zeZipReader.ENCRYPTION_MODE_PKZIPSTRONG:10==e.version||20==e.version||21==e.version||45==e.version||46==e.version||63==e.version||788==e.version||e.compressionMethod==zeZipReader.COMPRESSION_MODE_BZIP||e.compressionMethod==zeZipReader.COMPRESSION_MODE_LZMA||e.compressionMethod==zeZipReader.COMPRESSION_MODE_PPMD?e.encryptionMode=zeZipReader.ENCRYPTION_MODE_PKZIPSTANDARD:e.encryptionMode=zeZipReader.ENCRYPTION_MODE_PKZIPOTHER))},zeZipReader.decompressZipEntry=function(r,e,i,t,E,a,R,n,o,d,p,_,Z,s,A,I,z){if(0!=e.byteLength)if(e.byteLength<4)p(zeZipReader.ERR_ENTRY_BAD_FORMAT+" - Not enough bytes in entry data payload for local file signature");else if(e.getUint32(0)==zeZipReader.ZIP_LOCAL_FILE_HEADER_SIGNATURE)if(e.byteLength<zeZipReader.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES)p(zeZipReader.ERR_ENTRY_BAD_FORMAT+" - Not enough bytes in entry data payload");else{var D=e.getUint16(26,!0),O=e.getUint16(28,!0),T=1==(1&a);if(!T||null!=s&&0!=s.length){var S=zeZipReader.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES+D+O,C=null;if(T){if(null==(N=zeZipReader.processZipEncryptionHeader(o,t,e,S,D,O,p,s,A)))return;if(C=N.encryptionParams,t=N.newCompressedSize,S=N.newHeaderDataOffset,N.hasAuthenticationCode){A=i+N.authenticationCodeOffset;return void ze.App.blobToByteArrayAsync(r,A,A+N.authenticationCodeLength,function(e){C.authenticationCodeBytes=e;e=i+S;zeZipReader.decompressZipPayload(r,e,t,E,a,R,n,o,d,p,C,_,Z,I,z)},p)}}var N=i+S;zeZipReader.decompressZipPayload(r,N,t,E,a,R,n,o,d,p,C,_,Z,I,z)}else p(zeZipReader.ERR_INFLATION+" - ZIP file is encrypted but no password was provided")}else p(zeZipReader.ERR_ENTRY_BAD_FORMAT+" - Did not find Local File Header signature for this entry. Instead, found bytes: ("+e.getUint8(0)+", "+e.getUint8(1)+", "+e.getUint8(2)+", "+e.getUint8(3)+")");else p(zeZipReader.ERR_ENTRY_BAD_FORMAT+" - Empty Entry Data Payload in DataView")},zeZipReader.decompressZipPayload=function(e,r,i,t,E,a,R,n,o,d,p,_,Z,s,A){var I=null,z=null,D={};if(R===zeZipReader.COMPRESSION_MODE_BZIP)I=ze.App.LIB_BZIP_SCRIPT_NAME,z=ze.App.CHUNK_SIZE_BZIP;else if(R===zeZipReader.COMPRESSION_MODE_LZMA){if(i<5)return void d("ZIP file LZMA compressedSize must be at least 5, but was: "+i);I=ze.App.LIB_LZMA_SCRIPT_NAME,z=ze.App.CHUNK_SIZE_LZMA,t=2==(2&E)?-1:t}else if(R===zeZipReader.COMPRESSION_MODE_XZ)I=ze.App.LIB_XZ_SCRIPT_NAME,z=ze.App.CHUNK_SIZE_XZ;else if(R===zeZipReader.COMPRESSION_MODE_PPMD)I=ze.App.LIB_PPMDI_SCRIPT_NAME,z=ze.App.CHUNK_SIZE_PPMDI;else{if(R===zeZipReader.COMPRESSION_MODE_JPEG||R===zeZipReader.COMPRESSION_MODE_WAVPACK)return void d("Unsupported ZIP compression method in decompressZipEntry(): "+R);var O=R==zeZipReader.COMPRESSION_MODE_DEFLATE,T=R==zeZipReader.COMPRESSION_MODE_ENHANCED_DEFLATE,E=R===zeZipReader.COMPRESSION_MODE_STORE;if(!(O||T||E))return void d("Unsupported ZIP compression method; expected Enhanced or Standard DEFLATE, or STORE, but was: "+R);I=ze.App.LIB_INFLATE_SCRIPT_NAME,T?D.deflate64=!0:E&&(D.stored=!0),z=E?ze.App.CHUNK_SIZE_COPY:ze.App.CHUNK_SIZE_INFLATE}ze.App.genericDecompressWithWorker(new Worker(I),z,e,r,i,t,a,o,d,n,p,D,_,Z,!0,s,void 0,void 0,A)},zeZipReader.processZipEncryptionHeader=function(e,r,i,t,E,a,R,n,o){var d={};if(e==zeZipReader.ENCRYPTION_MODE_PKZIPSTANDARD){d.newCompressedSize=r-zeZipReader.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH;var p=new Int8Array(i.buffer,t,zeZipReader.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH);d.encryptionParams=zeZipReader.Crypto.deriveZipCryptoKeys(p,n),d.newHeaderDataOffset=t+zeZipReader.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH}else{if(e!=zeZipReader.ENCRYPTION_MODE_WINZIPAES)return R("Decryption error: Unsupported encryption mode: "+e),null;if(null==o)return R(zeZipReader.ERR_INFLATION+" - ZIP file is AES password protected but AES Key Strength was not provided"),null;var _=o/16,p=_+zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH;if(t+p>i.byteLength)return R("Decryption error: Encrypted Header ("+(t+p)+") extends past dataView ("+i.byteLength+")"),null;var Z=new Uint8Array(i.buffer,t,_);try{var s=performance.now();d.encryptionParams=zeZipReader.Crypto.Aes.initializeWinzipAes(o,Z,n);performance.now()}catch(e){return R(e),null}e=t+_,e=new Uint8Array(i.buffer,e,zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH);if(e[0]!=d.encryptionParams.derivedPasswordVerificationBytes[0]||e[1]!=d.encryptionParams.derivedPasswordVerificationBytes[1])return R("Incorrect Password. Password did not match verification bytes."),null;r=r-_-zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH-zeZipReader.Crypto.Aes.AUTHENTICATION_CODE_LENGTH;d.newCompressedSize=r;r=t+_+zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH+r;d.hasAuthenticationCode=!0,d.authenticationCodeOffset=r,d.authenticationCodeLength=zeZipReader.Crypto.Aes.AUTHENTICATION_CODE_LENGTH,d.newHeaderDataOffset=t+p}return d},zeZipReader.Crypto={},zeZipReader.Crypto.ENCRYPTION_HEADER_LENGTH=12,zeZipReader.Crypto.CRC_TABLE=null,zeZipReader.Crypto.ensureCrc32LookupTableForZipCryptoComputed=function(){if(null==zeZipReader.Crypto.CRC_TABLE){for(var e=new Int32Array(256),r=0;r<256;r++){for(var i=r,t=0;t<8;t++)1==(1&i)?i=i>>>1^3988292384:i>>>=1;e[r]=i}zeZipReader.Crypto.CRC_TABLE=e}},zeZipReader.Crypto.crc32=function(e,r){return e>>>8^zeZipReader.Crypto.CRC_TABLE[255&(e^r)]},zeZipReader.Crypto.deriveZipCryptoKeys=function(e,r){if(!e||e.length!=zeZipReader.Crypto.ENCRYPTION_HEADER_LENGTH)throw new Error("ZipCrypto error: Encrypted Header must be 12 bytes long");zeZipReader.Crypto.ensureCrc32LookupTableForZipCryptoComputed();var i=new Int32Array(3);i[0]=305419896,i[1]=591751049,i[2]=878082192;for(var t=new Int8Array(1),E=0,a=0;a<r.length;a++)zeZipReader.Crypto.update_keys_from_byte(i,r[a]),E=2|i[2],t[0]=Math.imul(E,1^E)>>>8;for(var R=new Int8Array(zeZipReader.Crypto.ENCRYPTION_HEADER_LENGTH),n=0;n<zeZipReader.Crypto.ENCRYPTION_HEADER_LENGTH;n++)R[n]=zeZipReader.Crypto.update_keys_from_byte(i,e[n]^t[0]),E=2|i[2],t[0]=Math.imul(E,1^E)>>>8;var o={};return o.keys=i,o},zeZipReader.Crypto.update_keys_from_byte=function(e,r){return e[0]=zeZipReader.Crypto.crc32(e[0],r),e[1]+=255&e[0],e[1]=Math.imul(e[1],134775813)+1,e[2]=zeZipReader.Crypto.crc32(e[2],e[1]>>24&255),r},zeZipReader.Crypto.decryptChunkBytesInPlaceZipCrypto=function(e,r){var i=r.keys;if(!i||3!=i.length)throw new Error("ZipCrypto error: Decryption keys required for ZipCrypto encryption");for(var t=2|i[2],E=zeZipReader.Crypto.CRC_TABLE,a=0;a<e.length;a++)e[a]^=Math.imul(t,1^t)>>>8,i[0]=i[0]>>>8^E[255&(i[0]^e[a])],i[1]=Math.imul(i[1]+(255&i[0]),134775813)+1,i[2]=i[2]>>>8^E[255&(i[2]^i[1]>>24)],t=2|i[2]},zeZipReader.Crypto.Aes={},zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH=2,zeZipReader.Crypto.Aes.AUTHENTICATION_CODE_LENGTH=10,zeZipReader.Crypto.Aes.VENDOR_ID_SIGNATURE=17729,zeZipReader.Crypto.Aes.EXTRA_DATA_RECORD_LENGTH=11,zeZipReader.Crypto.Aes.AE1_SIGNATURE_BYTE=1,zeZipReader.Crypto.Aes.AE2_SIGNATURE_BYTE=2,zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_128=1,zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_192=2,zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_256=3,zeZipReader.Crypto.Aes.AES_BLOCK_SIZE=16,zeZipReader.Crypto.Aes.PBKDF2_ITERATIONS=1e3,zeZipReader.Crypto.Aes.readAesExtraDataRecord=function(e,r){var i={},t=e.getUint16(r,!0);i.vendorVersion=t,i.encryptionMode=t==zeZipReader.Crypto.Aes.AE1_SIGNATURE_BYTE?"AE-1":t==zeZipReader.Crypto.Aes.AE2_SIGNATURE_BYTE?"AE-2":"Unknown";t=e.getUint16(r+2,!0);if((i.vendorId=t)!=zeZipReader.Crypto.Aes.VENDOR_ID_SIGNATURE)throw new Error('AES Decryption error: Expected "AE" for Vendor ID, instead found: '+t);t=e.getUint8(r+4,!0);if(i.encryptionStrengthMode=t,i.keyStrengthBits=t==zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_128?128:t==zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_192?192:t==zeZipReader.Crypto.Aes.ENCRYPTION_STRENGTH_256?256:-1,-1==i.keyStrengthBits)throw new Error("AES Decryption error: Invalid AES Encryption Strength: "+i.keyStrengthBits+" ("+i.encryptionStrengthMode+")");return i.compressionMethod=e.getUint16(r+5,!0),i},zeZipReader.Crypto.Aes.initializeWinzipAes=function(e,r,i){var t=e/8,E=t,a=t+E+zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH,e=Sha1.pbkdf2(i,r,zeZipReader.Crypto.Aes.PBKDF2_ITERATIONS,a);if(e.length!=a)throw new Error("AES Decryption error: derivedKeyBytes length ("+e.length+") does not match expected ("+a+")");i=e.slice(0,t),r=e.slice(t,t+E),a={};return a.derivedPasswordVerificationBytes=e.slice(t+E,t+E+zeZipReader.Crypto.Aes.PASSWORD_VERIFIER_LENGTH),a.hmac=Sha1.createhmacSha1(r),a.aes=new aesjs.ModeOfOperation.ctr(i,1,!0),a},zeZipReader.Crypto.Aes.verifyWinzipAesAuthenticationCode=function(e,r){var i=r.digest();if(!i||i.length<zeZipReader.Crypto.Aes.AUTHENTICATION_CODE_LENGTH)throw new Error("AES Decryption error: Could not get minimum 10 bytes from final Mac digest to authenticate");for(var t=!0,E=0;E<zeZipReader.Crypto.Aes.AUTHENTICATION_CODE_LENGTH;E++)if(e[E]!=i[E]){t=!1;break}return!!t},zeZipReader.Crypto.Aes.decryptChunkBytesInPlaceWinZipAes=function(e,r){r.hmac.update(e),r.aes.encryptOrDecryptFullChunkInPlaceFast(e)};